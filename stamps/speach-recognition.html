<template element="speach-recognition" constructor="SpeachRecognition">
	
	<content></content>
	
	
	
    <script>
	(function () {
	
	
		var SpeachRecognition = function () {
            this.continuous = true;
            this.text = '';
			
            var speechRecognition = window.SpeechRecognition ||
                                    window.webkitSpeechRecognition ||
                                    window.mozSpeechRecognition ||
                                    window.msSpeechRecognition ||
                                    window.oSpeechRecognition;

            if (speechRecognition !== undefined) {
                this.recognition = new speechRecognition();
            }
            else {
                console.error('Your browser do not support the Web Speech API');
            }
			this.ready();
		};
	
		SpeachRecognition.prototype = {
	               /* -- Attributes ------------------------------------------------ */

	               /* -- Lifecycle ------------------------------------------------- */
	               created: function() {

	               },
	               ready: function() {
	                   this.recognition.continuous = this.continuous;
	                   this.recognition.interimResults = false;

	                   // Initialize event listeners
	                   [
	                       'start',
	                       'error',
	                       'end'
	                   ].forEach(this.propagateEvent.bind(this));
	                   this.bindResult();
	               },

	               /* -- Methods --------------------------------------------------- */
	               start: function() {
	                   this.recognition.start();
	               },
	               stop: function() {
	                   this.recognition.stop();
	               },
	               abort: function() {
	                   this.recognition.abort();
	               },

	               /* -- Events ---------------------------------------------------- */
	               propagateEvent: function (eventName) {
	                   // this.recognition.addEventListener(eventName, this[eventName].bind(this));
	               },
	               bindResult: function() {
	                   var that = this;

	                   this.recognition.addEventListener('result', function(e) {
						   // alert('asdf')
	                       for (var i = e.resultIndex; i < e.results.length; ++i) {
	                           this.innerHTML += e.results[i][0].transcript;
	                           e.result = that.innerHTML;
	                       }

	                       // that.fire('result', e);
	                   }.bind(this));
	               }
	           };
			   
		

	   		var event = document.createEvent("CustomEvent");
	   		event.initCustomEvent("register-stamp", true, true, {
		
	   			name: "SpeachRecognition",
	   			scope: SpeachRecognition
		
	   		});
	
	
	
	   		document.dispatchEvent(event);
	
		
	
		
	}());
       </script>
	
</template>